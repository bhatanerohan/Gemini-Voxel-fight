{
  "version": 3,
  "sources": ["../../three/examples/jsm/renderers/CSS2DRenderer.js"],
  "sourcesContent": ["import {\r\n\tMatrix4,\r\n\tObject3D,\r\n\tVector3\r\n} from 'three';\r\n\r\nclass CSS2DObject extends Object3D {\r\n\r\n \tconstructor( element ) {\r\n\r\n\t\tsuper();\r\n\r\n\t\tthis.element = element || document.createElement( 'div' );\r\n\r\n\t\tthis.element.style.position = 'absolute';\r\n\r\n\t\tthis.addEventListener( 'removed', function () {\r\n\r\n\t\t\tthis.traverse( function ( object ) {\r\n\r\n\t\t\t\tif ( object.element instanceof Element && object.element.parentNode !== null ) {\r\n\r\n\t\t\t\t\tobject.element.parentNode.removeChild( object.element );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} );\r\n\r\n\t\t} );\r\n\r\n\t}\r\n\r\n\tcopy( source, recursive ) {\r\n\r\n\t\tsuper.copy( source, recursive );\r\n\r\n\t\tthis.element = source.element.cloneNode( true );\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n}\r\n\r\nCSS2DObject.prototype.isCSS2DObject = true;\r\n\r\n//\r\n\r\nconst _vector = new Vector3();\r\nconst _viewMatrix = new Matrix4();\r\nconst _viewProjectionMatrix = new Matrix4();\r\nconst _a = new Vector3();\r\nconst _b = new Vector3();\r\n\r\nclass CSS2DRenderer {\r\n\r\n\tconstructor() {\r\n\r\n\t\tconst _this = this;\r\n\r\n\t\tlet _width, _height;\r\n\t\tlet _widthHalf, _heightHalf;\r\n\r\n\t\tconst cache = {\r\n\t\t\tobjects: new WeakMap()\r\n\t\t};\r\n\r\n\t\tconst domElement = document.createElement( 'div' );\r\n\t\tdomElement.style.overflow = 'hidden';\r\n\r\n\t\tthis.domElement = domElement;\r\n\r\n\t\tthis.getSize = function () {\r\n\r\n\t\t\treturn {\r\n\t\t\t\twidth: _width,\r\n\t\t\t\theight: _height\r\n\t\t\t};\r\n\r\n\t\t};\r\n\r\n\t\tthis.render = function ( scene, camera ) {\r\n\r\n\t\t\tif ( scene.autoUpdate === true ) scene.updateMatrixWorld();\r\n\t\t\tif ( camera.parent === null ) camera.updateMatrixWorld();\r\n\r\n\t\t\t_viewMatrix.copy( camera.matrixWorldInverse );\r\n\t\t\t_viewProjectionMatrix.multiplyMatrices( camera.projectionMatrix, _viewMatrix );\r\n\r\n\t\t\trenderObject( scene, scene, camera );\r\n\t\t\tzOrder( scene );\r\n\r\n\t\t};\r\n\r\n\t\tthis.setSize = function ( width, height ) {\r\n\r\n\t\t\t_width = width;\r\n\t\t\t_height = height;\r\n\r\n\t\t\t_widthHalf = _width / 2;\r\n\t\t\t_heightHalf = _height / 2;\r\n\r\n\t\t\tdomElement.style.width = width + 'px';\r\n\t\t\tdomElement.style.height = height + 'px';\r\n\r\n\t\t};\r\n\r\n\t\tfunction renderObject( object, scene, camera ) {\r\n\r\n\t\t\tif ( object.isCSS2DObject ) {\r\n\r\n\t\t\t\tobject.onBeforeRender( _this, scene, camera );\r\n\r\n\t\t\t\t_vector.setFromMatrixPosition( object.matrixWorld );\r\n\t\t\t\t_vector.applyMatrix4( _viewProjectionMatrix );\r\n\r\n\t\t\t\tconst element = object.element;\r\n\r\n\t\t\t\tif ( /apple/i.test( navigator.vendor ) ) {\r\n\r\n\t\t\t\t\t// https://github.com/mrdoob/three.js/issues/21415\r\n\t\t\t\t\telement.style.transform = 'translate(-50%,-50%) translate(' + Math.round( _vector.x * _widthHalf + _widthHalf ) + 'px,' + Math.round( - _vector.y * _heightHalf + _heightHalf ) + 'px)';\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\telement.style.transform = 'translate(-50%,-50%) translate(' + ( _vector.x * _widthHalf + _widthHalf ) + 'px,' + ( - _vector.y * _heightHalf + _heightHalf ) + 'px)';\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\telement.style.display = ( object.visible && _vector.z >= - 1 && _vector.z <= 1 ) ? '' : 'none';\r\n\r\n\t\t\t\tconst objectData = {\r\n\t\t\t\t\tdistanceToCameraSquared: getDistanceToSquared( camera, object )\r\n\t\t\t\t};\r\n\r\n\t\t\t\tcache.objects.set( object, objectData );\r\n\r\n\t\t\t\tif ( element.parentNode !== domElement ) {\r\n\r\n\t\t\t\t\tdomElement.appendChild( element );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tobject.onAfterRender( _this, scene, camera );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( let i = 0, l = object.children.length; i < l; i ++ ) {\r\n\r\n\t\t\t\trenderObject( object.children[ i ], scene, camera );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction getDistanceToSquared( object1, object2 ) {\r\n\r\n\t\t\t_a.setFromMatrixPosition( object1.matrixWorld );\r\n\t\t\t_b.setFromMatrixPosition( object2.matrixWorld );\r\n\r\n\t\t\treturn _a.distanceToSquared( _b );\r\n\r\n\t\t}\r\n\r\n\t\tfunction filterAndFlatten( scene ) {\r\n\r\n\t\t\tconst result = [];\r\n\r\n\t\t\tscene.traverse( function ( object ) {\r\n\r\n\t\t\t\tif ( object.isCSS2DObject ) result.push( object );\r\n\r\n\t\t\t} );\r\n\r\n\t\t\treturn result;\r\n\r\n\t\t}\r\n\r\n\t\tfunction zOrder( scene ) {\r\n\r\n\t\t\tconst sorted = filterAndFlatten( scene ).sort( function ( a, b ) {\r\n\r\n\t\t\t\tconst distanceA = cache.objects.get( a ).distanceToCameraSquared;\r\n\t\t\t\tconst distanceB = cache.objects.get( b ).distanceToCameraSquared;\r\n\r\n\t\t\t\treturn distanceA - distanceB;\r\n\r\n\t\t\t} );\r\n\r\n\t\t\tconst zMax = sorted.length;\r\n\r\n\t\t\tfor ( let i = 0, l = sorted.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tsorted[ i ].element.style.zIndex = zMax - i;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\r\n\r\nexport { CSS2DObject, CSS2DRenderer };\r\n"],
  "mappings": "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",
  "names": []
}
